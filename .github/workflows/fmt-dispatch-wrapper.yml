name: FMT Prediction Trigger (Wrapped)

on:
  workflow_dispatch:
    inputs:
      team_1:
        description: "Home team"
        required: true
      team_2:
        description: "Away team"
        required: true
      competition:
        description: "Competition"
        required: true
      date:
        description: "Fixture date (YYYY-MM-DD)"
        required: true

jobs:
  dispatch:
    runs-on: ubuntu-latest
    steps:
      - name: ‚è© Forward to FMT Core Chain
        uses: actions/github-script@v6
        with:
          script: |
            const axios = require('axios');
            const payload = {
              ref: 'main',
              inputs: {
                team_1: '${{ github.event.inputs.team_1 }}',
                team_2: '${{ github.event.inputs.team_2 }}',
                competition: '${{ github.event.inputs.competition }}',
                date: '${{ github.event.inputs.date }}'
              }
            };
            await axios.post(
              'https://api.github.com/repos/${{ github.repository }}/actions/workflows/fmt-core-chain/force-fmt-executor-v2.yml/dispatches',
              payload,
              {
                headers: {
                  'Authorization': `Bearer ${{ secrets.GITHUB_TOKEN }}`,
                  'Accept': 'application/vnd.github.v3+json'
                }
              }
            );
